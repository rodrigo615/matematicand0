<!DOCTYPE html> 
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Jogo do Matematicando</title>
<style>
    body { 
        font-family: Arial, sans-serif; 
        text-align: center; 
        padding: 5vw; 
        background: #fdf6e3; 
        max-width: 800px; 
        margin: auto; 
    }

    h1 { 
        color: #2c3e50; 
        font-size: 6vw; 
    }

    .expression { 
        font-size: 5vw; 
        margin: 5vw 0; 
        font-weight: bold; 
    }

    input[type="number"] { 
        font-size: 4.5vw; 
        padding: 2vw; 
        width: 60%; 
        max-width: 250px; 
        text-align: center; 
    }

    .buttons {
        display: flex;
        justify-content: center;
        gap: 3vw;
        flex-wrap: wrap;
        margin-top: 3vw;
    }

    button { 
        font-size: 4vw; 
        padding: 2vw 5vw; 
        cursor: pointer; 
        border-radius: 1vw; 
        border: none; 
        background-color: #3498db; 
        color: white; 
        transition: background-color 0.3s; 
    }

    button:hover { background-color: #2980b9; }

    .feedback { 
        font-size: 4.5vw; 
        margin: 3vw 0; 
        font-weight: bold; 
    }

    .score { 
        font-size: 4vw; 
        margin-top: 3vw; 
    }

    @media (min-width: 1024px) {
        h1 { font-size: 40px; }
        .expression { font-size: 32px; }
        input[type="number"] { font-size: 22px; }
        button { font-size: 20px; padding: 12px 24px; border-radius: 6px; }
        .feedback { font-size: 24px; }
        .score { font-size: 22px; }
    }
</style>
</head>
<body>

<h1>Jogo do Matematicando</h1>
<div class="expression" id="expression">Clique em "PrÃ³xima" para comeÃ§ar!</div>
<input type="number" id="answer" placeholder="Sua resposta">

<div class="buttons">
  <button onclick="checkAnswer()">Verificar</button>
  <button onclick="nextExpression()">PrÃ³xima</button>
</div>

<div class="feedback" id="feedback"></div>
<div class="score" id="score">PontuaÃ§Ã£o: 0</div>

<script>
let currentExpression = null;
let score = 0;
let alreadyAnswered = false;

// Substitua pelo seu domÃ­nio no PythonAnywhere:
const SERVER = "https://matematicando.pythonanywhere.com";

// Pega uma questÃ£o do servidor
async function nextExpression() {
    const feedbackEl = document.getElementById("feedback");

    if (currentExpression && !alreadyAnswered) {
        feedbackEl.innerText = "VocÃª nÃ£o respondeu a questÃ£o ðŸ˜¢. PontuaÃ§Ã£o zerada!";
        feedbackEl.style.color = "red";
        score = 0;
        document.getElementById("score").innerText = "PontuaÃ§Ã£o: " + score;
    }

    const res = await fetch(`${SERVER}/next`);
    const data = await res.json();

    currentExpression = data.expr;
    document.getElementById("expression").innerText = currentExpression;
    document.getElementById("answer").value = "";
    feedbackEl.innerText = "";
    feedbackEl.style.color = "black";

    alreadyAnswered = false;
}

// Verifica resposta no servidor
async function checkAnswer() {
    if (alreadyAnswered || !currentExpression) return;

    const answer = Number(document.getElementById("answer").value);
    const feedbackEl = document.getElementById("feedback");

    const res = await fetch(`${SERVER}/check`, {
        method: "POST",
        headers: {"Content-Type": "application/json"},
        body: JSON.stringify({ expr: currentExpression, answer: answer })
    });
    const data = await res.json();

    if (data.correct) {
        score++;
        feedbackEl.innerText = "Correto! ðŸŽ‰";
        feedbackEl.style.color = "green";

        // Caso tenha acertado tudo
        if (score >= 50) {
            const codeRes = await fetch(`${SERVER}/codigo`);
            const codeData = await codeRes.json();
            feedbackEl.innerText = "ðŸŽŠ ParabÃ©ns! VocÃª acertou todas as 50 questÃµes! ðŸŽŠ\nCopie o cÃ³digo " 
                + codeData.codigo + " que vale 0,5 ponto para a prÃ³xima prova.";
            score = 0;
        }
    } else {
        feedbackEl.innerText = "Errado ðŸ˜¢. Resposta certa: " + data.correct_answer;
        feedbackEl.style.color = "red";
        score = 0;
    }

    document.getElementById("score").innerText = "PontuaÃ§Ã£o: " + score;
    alreadyAnswered = true;
}
</script>

</body>
</html>














