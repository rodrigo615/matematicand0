<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Jogo do Matematicando</title>
<style>
  /* mesmo CSS do seu original (omitido aqui por brevidade) */
  body { font-family: Arial, sans-serif; text-align: center; padding: 5vw; background: #fdf6e3; max-width: 800px; margin: auto; }
  h1 { color: #2c3e50; font-size: 6vw; }
  .expression { font-size: 5vw; margin: 5vw 0; font-weight: bold; }
  input[type="number"] { font-size: 4.5vw; padding: 2vw; width: 60%; max-width: 250px; text-align: center; }
  .buttons { display: flex; justify-content: center; gap: 3vw; flex-wrap: wrap; margin-top: 3vw; }
  button { font-size: 4vw; padding: 2vw 5vw; cursor: pointer; border-radius: 1vw; border: none; background-color: #3498db; color: white; transition: background-color 0.3s; }
  button:hover { background-color: #2980b9; }
  .feedback { font-size: 4.5vw; margin: 3vw 0; font-weight: bold; white-space: pre-line; }
  .score { font-size: 4vw; margin-top: 3vw; }
</style>
</head>
<body>
<h1>Jogo do Matematicando</h1>
<div class="expression" id="expression">Clique em "Pr√≥xima" para come√ßar!</div>
<input type="number" id="answer" placeholder="Sua resposta">
<div class="buttons">
  <button id="btnCheck">Verificar</button>
  <button id="btnNext">Pr√≥xima</button>
</div>
<div class="feedback" id="feedback"></div>
<div class="score" id="score">Pontua√ß√£o: 0</div>

<script>
const API_URL = "https://matematicando.pythonanywhere.com"; // <-- substitua pelo seu dom√≠nio (HTTPS)

// estado
let currentExpression = null;
let score = 0;
let alreadyAnswered = false;

document.getElementById('btnNext').addEventListener('click', nextExpression);
document.getElementById('btnCheck').addEventListener('click', checkAnswer);

async function nextExpression() {
  const feedbackEl = document.getElementById("feedback");

  if (currentExpression && !alreadyAnswered) {
    feedbackEl.innerText = "Voc√™ n√£o respondeu a quest√£o üò¢. Pontua√ß√£o zerada!";
    feedbackEl.style.color = "red";
    score = 0;
    document.getElementById("score").innerText = "Pontua√ß√£o: " + score;
  }

  try {
    const res = await fetch(`${API_URL}/get_expression`);
    if (!res.ok) {
      const text = await res.text();
      throw new Error(`Erro ${res.status}: ${text}`);
    }
    const data = await res.json();
    currentExpression = data;
    document.getElementById("expression").innerText = data.expr;
    document.getElementById("answer").value = "";
    feedbackEl.innerText = "";
    feedbackEl.style.color = "black";
    alreadyAnswered = false;
  } catch (err) {
    console.error(err);
    document.getElementById("feedback").innerText = "Erro ao buscar quest√£o. Abra o console para detalhes.";
    document.getElementById("feedback").style.color = "red";
  }
}

async function checkAnswer() {
  const feedbackEl = document.getElementById("feedback");
  if (!currentExpression) { feedbackEl.innerText = "Clique em Pr√≥xima primeiro."; return; }
  if (alreadyAnswered) return;

  const answer = Number(document.getElementById("answer").value);

  try {
    const res = await fetch(`${API_URL}/check_answer`, {
      method: 'POST',
      headers: {'Content-Type': 'application/json'},
      body: JSON.stringify({ id: currentExpression.id, answer })
    });

    if (!res.ok) {
      const txt = await res.text();
      throw new Error(`Erro ${res.status}: ${txt}`);
    }

    const data = await res.json();
    if (data.correct) {
      score++;
      feedbackEl.innerText = "Correto! üéâ";
      feedbackEl.style.color = "green";
      if (score === 50) {
        const finalRes = await fetch(`${API_URL}/finish`);
        const finalData = await finalRes.json();
        feedbackEl.innerText = finalData.message;
        score = 0;
      }
    } else {
      feedbackEl.innerText = "Errado üò¢. Resposta certa: " + data.correct_answer;
      feedbackEl.style.color = "red";
      score = 0;
    }
    document.getElementById("score").innerText = "Pontua√ß√£o: " + score;
    alreadyAnswered = true;
  } catch (err) {
    console.error(err);
    feedbackEl.innerText = "Erro ao verificar resposta. Veja o console (F12).";
    feedbackEl.style.color = "red";
  }
}
</script>
</body>
</html>













